<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Probability (BST 230) Notes - 9&nbsp; Week 8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../week9/week9.html" rel="next">
<link href="../week7/week7.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-title">Week 8</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Probability (BST 230) Notes</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Methods (BST 232) Notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week1/week1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week2/week2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week3/week3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week4/week4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week5/week5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week6/week6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week7/week7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week8/week8.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Week 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week9/week9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 9</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/week10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/week11.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 11</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/week13.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 13</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week14/week14.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 14</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#recap" id="toc-recap" class="nav-link active" data-scroll-target="#recap">Recap</a>
  <ul class="collapse">
  <li><a href="#correlation-and-covariance" id="toc-correlation-and-covariance" class="nav-link" data-scroll-target="#correlation-and-covariance">Correlation and Covariance</a></li>
  </ul></li>
  <li><a href="#bivariate-transformations" id="toc-bivariate-transformations" class="nav-link" data-scroll-target="#bivariate-transformations">Bivariate Transformations</a>
  <ul class="collapse">
  <li><a href="#transforming-two-variables-into-one-variable" id="toc-transforming-two-variables-into-one-variable" class="nav-link" data-scroll-target="#transforming-two-variables-into-one-variable">Transforming two variables into one variable</a>
  <ul class="collapse">
  <li><a href="#example-transformation-of-uniforms" id="toc-example-transformation-of-uniforms" class="nav-link" data-scroll-target="#example-transformation-of-uniforms">Example: Transformation of Uniforms</a></li>
  <li><a href="#example-ratio-of-standard-normals" id="toc-example-ratio-of-standard-normals" class="nav-link" data-scroll-target="#example-ratio-of-standard-normals">Example: Ratio of Standard Normals</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bivariate-normal-distributions" id="toc-bivariate-normal-distributions" class="nav-link" data-scroll-target="#bivariate-normal-distributions">Bivariate Normal Distributions</a>
  <ul class="collapse">
  <li><a href="#mean-and-covariance-of-a-random-vector" id="toc-mean-and-covariance-of-a-random-vector" class="nav-link" data-scroll-target="#mean-and-covariance-of-a-random-vector">Mean and Covariance of a Random Vector</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Week 8</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="recap" class="level1">
<h1>Recap</h1>
<section id="correlation-and-covariance" class="level2">
<h2 class="anchored" data-anchor-id="correlation-and-covariance">Correlation and Covariance</h2>
<p>When random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are not independent, they are dependent. However, the dependence may be weak, or it may be strong. Correlation is an important way of quantifying the dependence between random variables. Covariance is a related concept that also depends on the scales of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>To declutter the notation, let’s denote</p>
<p><span class="math display">\[
\begin{aligned}
\mu_X = \mathbb{E}X \quad &amp; \quad \sigma_x = \sqrt{\text{Var}X } \\
\mu_Y = \mathbb{E}Y \quad &amp; \quad \sigma_y = \sqrt{\text{Var}Y }
\end{aligned}
\]</span></p>
<p>The covariance of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is</p>
<p><span class="math display">\[
\text{Cov}(X,Y) = \mathbb{E}\bigg( (X - \mu_X) ( Y - \mu_Y )\bigg).
\]</span></p>
<p>The correlation of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
\rho_{X,Y} = \text{Cor}(X,Y) &amp; = \frac{\text{Cov}(X,Y)}{\sigma_X \sigma_Y} \\
&amp; = \mathbb{E}\left( \left(\frac{X - \mu_X }{\sigma_X}\right) \left(\frac{Y - \mu_Y}{\sigma_Y}\right) \right).
\end{aligned}
\]</span></p>
<p>This is sometimes called the <span class="vocab">correlation coefficient</span>, or <span class="vocab">Pearson’s correlation coefficient</span>.</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Correlation_examples2.svg/2880px-Correlation_examples2.svg.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Example of correlations from Wikimedia</figcaption><p></p>
</figure>
</div>
<p>Note that in the center figure, division by zero (with <span class="math inline">\(\sigma_Y = 0\)</span>) implies that the correlation is undefined. Notably, that scenario would have covariance.</p>
<p>It’s important to acknowledge that correlation is not going to relate necessarily to the slope of a regression line because we are standardizing by <span class="math inline">\(\sigma_Y\)</span>.</p>
<p>Properties of <span class="math inline">\(-1 \leq \rho_{X,Y} \leq 1\)</span>.</p>
<p><span class="math inline">\(\rho_{X,Y} &gt; 0\)</span> implies a positive association (direct relationship); <span class="math inline">\(\rho_{X,Y} &lt; 0\)</span> implies a negative association.</p>
<p>If <span class="math inline">\(\sigma_X = 0\)</span> or <span class="math inline">\(\sigma_Y = 0\)</span>, then <span class="math inline">\(\rho\)</span> is undefiend.</p>
<p><span class="math inline">\(|\rho_{X,Y}| = 1\)</span> if and only if there exists <span class="math inline">\(a \neq 0\)</span> and <span class="math inline">\(b \in \mathbb R\)</span> such that <span class="math inline">\(P(Y = aX+b) = 1\)</span>. The sign of <span class="math inline">\(\rho\)</span> equals the sign of <span class="math inline">\(a\)</span>.</p>
<p>Correlation captures the strength of the association in terms of how close to linear the relationship is, but not the magnitude of the slope.</p>
<p>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, then <span class="math inline">\(\rho_{X,Y} = 0\)</span>. However, if <span class="math inline">\(\rho_{X,Y} = 0\)</span> then <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are not necessarily independent.</p>
<div class="chilltip">
<p>If we want to show that independence <span class="math inline">\(\to \rho = 0\)</span>, we can see that by writing that we want to show:</p>
<p><span class="math display">\[\text{Cov}(X,Y) = \mathbb{E}\biggr( (X - \mu_X) (Y - \mu_Y) \biggr) = 0.
\]</span></p>
<p>Because <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, and the expectation is over a product of a piece that’s just a function of <span class="math inline">\(X\)</span> and another piece that’s just a function of <span class="math inline">\(Y\)</span>, we can write that</p>
<p><span class="math display">\[
\text{Cov}(X,Y) = \mathbb{E}\biggr( X - \mu_X \biggr)\mathbb{E}\biggr( Y - \mu_Y \biggr) = 0 \times 0 = 0.
\]</span></p>
<p><span class="math display">\[
\Longrightarrow \text{Cor}(X,Y) = \rho_{X,Y} = 0
\]</span></p>
</div>
<p>Properties of covariance</p>
<ol type="1">
<li><span class="math inline">\(\text{Cov}(X,Y) = \rho_{X,Y} \sigma_X \sigma_Y\)</span></li>
<li><span class="math inline">\(\text{Cov}(X,Y) = \mathbb{E}XY - (EX)(EY)\)</span></li>
<li><span class="math inline">\(\text{Cov}(X,X) = \text{Var}X\)</span></li>
<li><span class="math inline">\(\text{Cov}(aX + b, cY+d) = ac \text{Cov}(X,Y)\)</span></li>
<li><span class="math inline">\(\text{Var}(X + Y) = \text{Var}(X) + \text{Var}(Y) + 2 \text{Cov}(X,Y)\)</span></li>
</ol>
<div class="bluetip">
<p>Showing 1:</p>
<p>Observe that <span class="math inline">\(\rho_{X,Y} = \text{Cov}(X,Y) / (\sigma_X \sigma_Y)\)</span> implies this.</p>
<p>Showing 2: We can write that</p>
<p><span class="math display">\[
\begin{aligned}
\text{Cov}(X,Y) &amp; = \mathbb{E}(XY - \mu_X Y - \mu_Y X + \mu_X \mu_Y) \\
&amp; = \mathbb{E}(XY) - \mathbb{E}(X) \mathbb{E}(Y) - \mathbb{E}(Y) \mathbb{E}(X) + \mathbb{E}(X)\mathbb{E}(Y) \\
&amp; = \mathbb{E}(XY) - \mathbb{E}(X) \mathbb{E}(Y).
\end{aligned}
\]</span></p>
<p>Showing 3:</p>
<p><span class="math display">\[\text{Cov}(X,X) = \mathbb{E}((X - \mu_X)(X-\mu_X)) = \mathbb{E}((X-\mu_X)^2) = \text{Var}(X).
\]</span></p>
<p>Showing 5:</p>
<!-- 
$$
\begin{aligned}
\Var(X + Y) & = \E((X + Y - \E(X + Y))^2) \\ 
& = \E((X+Y)^2 - 2(X + Y)\E(X + Y) - \E(X+Y)^2) \\ 
& = \E(X^2 + 2XY + Y^2 - 2(X+Y)(\EX + \EY) - (\E(X)^2 + 2\EX \EY + \EY^2)) \\ 
& = \E(X^2 + 2XY + Y^2 - 2(X+Y)\EX + 2(X+Y)\EY - (\E(X)^2 + 2\EX \EY + \EY^2)) \\ 
\end{aligned}
$$
-->
<p><span class="math display">\[
\begin{aligned}
\text{Var}(X+Y) &amp; = \mathbb{E}((X+Y)^2) - \mathbb{E}(X+Y)^2 \\
&amp; = \mathbb{E}(X^2 + 2XY + Y^2) - (\mathbb{E} X^2 + 2\mathbb{E} X\mathbb{E} Y+ \mathbb{E} Y^2) \\
&amp; = \mathbb{E}(X^2) + 2\mathbb{E}(XY) + \mathbb{E}(Y^2) - \mathbb{E} X^2 - 2\mathbb{E} X\mathbb{E} Y- \mathbb{E} Y^2 \\
&amp; = \underbrace{\mathbb{E}(X^2) - \mathbb{E} X^2}_{\text{Var}(X)} + \underbrace{\mathbb{E}(Y^2) - \mathbb{E} Y^2}_{\text{Var}(Y)} + \underbrace{2\mathbb{E}(XY) - 2\mathbb{E} X\mathbb{E} Y}_{=\text{Cov}(X,Y) \text{, by property 2}}
\end{aligned}
\]</span></p>
</div>
<p><br></p>
<div class="chilltip">
<p>The simpler way to derive 5 is to first consider a simpler case where <span class="math inline">\(\mu_X = 0\)</span> and <span class="math inline">\(\mu_Y = 0\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\text{Var}(X + Y) &amp; = \mathbb{E}((X+Y)^2) \\
&amp; = \mathbb{E} X^2 + 2\mathbb{E} X\mathbb{E} Y+ \mathbb{E} Y^2 \\
&amp; = \text{Var}(X) + \text{Var}(Y) + 2 \text{Cov}(X,Y)
\end{aligned}
\]</span></p>
<p>And if the means are not zero, we can apply that <span class="math inline">\(\text{Var}(X + b) = \text{Var}(X)\)</span> and <span class="math inline">\(\text{Var}(Y + d) = \text{Var}(d)\)</span>, and by property 4, <span class="math inline">\(\text{Cov}(X + b, Y + d) = \text{Cov}(X,Y)\)</span>.</p>
</div>
<p><br></p>
<div class="cooltip">
<p>As a side-note, if one wants to speak the formula</p>
<p><span class="math display">\[\text{Var}(X) = \mathbb{E}(X^2) - \mathbb{E}(X)^2
\]</span></p>
<p>aloud, then the best way to say it seems to be</p>
<p>“the variance of <span class="math inline">\(X\)</span> is the second moment of <span class="math inline">\(X\)</span> minus the mean of <span class="math inline">\(X\)</span> squared.”</p>
</div>
<p>If we’re doing linear regression with a single covariate, then the formula is <span class="math inline">\(Y = \alpha + \beta x + \varepsilon\)</span>. If we assume that <span class="math inline">\(x \perp\!\!\!\perp\varepsilon\)</span>, then</p>
<p><span class="math display">\[
\text{Cor}(X,Y) = \rho_{X,Y} = \beta \frac{\sigma_X}{\sigma_Y}
\]</span></p>
</section>
</section>
<section id="bivariate-transformations" class="level1">
<h1>Bivariate Transformations</h1>
<p>Suppose <span class="math inline">\((X,Y)\)</span> is a random vector, and <span class="math inline">\((U,V) = g(X,Y)\)</span> for some function <span class="math inline">\(g\)</span>.</p>
<p>That is <span class="math inline">\(U = g_1(X,Y)\)</span> and <span class="math inline">\(V = g_2(X,Y)\)</span>.</p>
<p>How can we derive the joint pdf/pmf of <span class="math inline">\((U,V)\)</span> from the joint pdf/pmf of <span class="math inline">\((X,Y)\)</span>?</p>
<p>The discrete case is pretty straightforward, but in the continuous case we need to get comfortable with the Jacobian matrix.</p>
<p>Suppose <span class="math inline">\((X,Y)\)</span> is a continuous random vector and <span class="math inline">\((U,V) = g(X,Y)\)</span> for some function <span class="math inline">\(g\)</span> such that</p>
<ol type="1">
<li><span class="math inline">\(g\)</span> is one-to one with inverse <span class="math inline">\(h(u,v) = (x,y)\)</span> on its range,</li>
<li>the partial derivatives of <span class="math inline">\(g(x,y)\)</span> exist and are oncintuous,</li>
<li>the Jacobian matrix <span class="math inline">\(Dh\)</span> is nonsingular, where</li>
</ol>
<p><span class="math display">\[Dh = \begin{bmatrix}
  \frac{\partial x}{\parital u} &amp; \frac{ \partial x}{\partial v} \\
  \frac{\partial y}{\partial u} &amp; \frac{\partial y}{\partial v}
  \end{bmatrix} =
  \begin{bmatrix}
  \frac{\partial h_1}{\parital u} &amp; \frac{ \partial h_1}{\partial v} \\
  \frac{\partial h_2}{\partial u} &amp; \frac{\partial h_2}{\partial v}
  \end{bmatrix}
  \]</span></p>
<p>The determinant factor is <span class="math display">\[|\det Dh| = \lvert \frac{\partial h_1 }{\partial u} \frac{\partial h_2}{\partial v} - \frac{\partial h_1}{\partial v} \frac{\partial h_2}{\partial u } \rvert.
\]</span></p>
<p>Suppose <span class="math inline">\(X,Y \sim \mathcal N(0,1)\)</span> independently and <span class="math inline">\(\rho \in (-1, 1)\)</span>.</p>
<p>Define <span class="math inline">\(U = X\)</span> and <span class="math inline">\(V = \rho X + \sqrt{1 - \rho^2}Y\)</span>. That is</p>
<p><span class="math display">\[u = g_1(x,y) = x
\]</span></p>
<p><span class="math display">\[v = g_2(x,y) = \rho x + \sqrt{1 - \rho^2} y.
\]</span></p>
<p>The inverse is defined by</p>
<p><span class="math display">\[x = h_1(u,v) = u
\]</span> <span class="math display">\[y = h_2(u,v) = \frac{v - \rho u }{\sqrt{1-\rho^2}}.
\]</span></p>
<p>Thus the Jacobian matrix is</p>
<p><span class="math display">\[
Dh =
  \begin{bmatrix}
  \frac{\partial h_1}{\partial u} &amp; \frac{ \partial h_1}{\partial v} \\
  \frac{\partial h_2}{\partial u} &amp; \frac{\partial h_2}{\partial v}
  \end{bmatrix} =
  \begin{bmatrix}
  1 &amp; 0 \\
  -\frac{\rho}{\sqrt{1 - \rho^2}} &amp; \frac{1}{\sqrt{1 - \rho^2}}
  \end{bmatrix}.
\]</span></p>
<p><span class="math display">\[\det Dh = \frac{1}{\sqrt{1 - \rho^2}}.
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
f_{X,Y}(x,y) &amp; = \frac{1}{\sqrt{2\pi}}\exp \biggr ( -\frac{1}{2} y^2\biggr ) \\
&amp; = \frac{1}{\sqrt{2\pi}}\exp \biggr ( -\frac{1}{2} u^2\biggr ) \exp \biggr ( - \frac{1}{2} \left( \frac{v - \rho u}{\sqrt{1-\rho^2}} \right)^2 \biggr )
\biggr \lvert \det Dh \biggr \rvert \\
&amp; = \frac{1}{2\pi \sqrt{1-\rho^2}}\exp \biggr ( -\frac{1}{2} u^2 - \frac{1}{2} \left( \frac{v^2 - 2v \rho u + \rho^2 u^2}{1-\rho^2} \right) \biggr ) \\
&amp; = \frac{1}{2\pi \sqrt{1-\rho^2}} \exp \biggr ( -\frac{1}{2 (1 - \rho^2)} \left( u^2 - 2\rho uv + v^2 \right) \biggr ).
\end{aligned}
\]</span></p>
<section id="transforming-two-variables-into-one-variable" class="level2">
<h2 class="anchored" data-anchor-id="transforming-two-variables-into-one-variable">Transforming two variables into one variable</h2>
<p>Often we want to know the distribution of a single random variable <span class="math inline">\(U = g_1(X,Y)\)</span> that is a function of <span class="math inline">\((X,Y)\)</span>. However, this is hardly ever an invertible transformation. Fortunately, it turns out that we can still use the bivariate transformation technique as follows.</p>
<p>Introduce a new “auxiliary” variable <span class="math inline">\(V = g_2(X,Y)\)</span>, chosen to make calculations as easy as possible.</p>
<p>Compute <span class="math inline">\(f_{U,V}(u,v)\)</span> from <span class="math inline">\(f_{X,Y}(x,y)\)</span> using the bivariate transformation formula.</p>
<p>Then, integrate to get the marginal density of <span class="math inline">\(U\)</span>:</p>
<p><span class="math display">\[f_U(u) = \int f_{U,V} (u,v) \mathrm d v.
\]</span></p>
<section id="example-transformation-of-uniforms" class="level3">
<h3 class="anchored" data-anchor-id="example-transformation-of-uniforms">Example: Transformation of Uniforms</h3>
<p>Let <span class="math inline">\(X,Y \sim \text{Uniform}(-1,1)\)</span> independently and suppose <span class="math inline">\(U = (X+Y)/2\)</span> and <span class="math inline">\(V = X-Y\)</span>.</p>
<p>What is the joint pdf of <span class="math inline">\((U,V)\)</span>? Also draw a picture of the joint pdf.</p>
<div class="bluetip">
<p>Since we’ll need this down the line, why don’t we go ahead and evaluate the elements of the Jacobian matrix:</p>
<p>We first need to invert these functions:</p>
<p><span class="math inline">\(2X = 2U + V \Longrightarrow X = U + V/2,\)</span></p>
<p>and <span class="math inline">\(2Y = 2U - V \Longrightarrow Y = U - V/2\)</span>.</p>
<p><span class="math display">\[
Dh = \begin{bmatrix}
\frac{\partial x}{\partial u} &amp; \frac{\partial x}{\partial v} \\
\frac{\partial y}{\partial u} &amp; \frac{\partial y}{\partial v} \\
\end{bmatrix} =
\begin{bmatrix}
1 &amp; 1/2 \\
1 &amp; -1/2 \\
\end{bmatrix}.
\]</span></p>
<p>So therefore we have that <span class="math inline">\(| \det Dh | = |-1/2 - 1/2| = |-1| = 1.\)</span></p>
<p>So the pdf will be</p>
<p><span class="math display">\[f_{U,V}(u,v) = f_{X,Y}(x(u,v), y(u,v)) | \det Dh |
\]</span></p>
<p>Therefore</p>
<p><span class="math display">\[f_{U,V}(u,v) = \frac{1}{4} \mathbb 1 (x(u,v) \in (-1,1)) \mathbb 1(y(u,v) \in (-1,1))
\]</span></p>
<p><span class="math display">\[f_{U,V}(u,v) = \frac{1}{4} \mathbb 1 (-1 &lt; u + v/2 &lt; 1) \mathbb 1(-1 &lt; u - v/2 &lt; 1)
\]</span></p>
<p><span class="math display">\[f_{U,V}(u,v) = \frac{1}{4} \mathbb 1 (-2 &lt; 2u + v &lt; 2) \mathbb 1(-2 &lt; 2u - v &lt; 2)
\]</span></p>
<p>One way to think through what these boundary conditions are is to treat these inequalities as four linear constraints.</p>
<p>Replacing <span class="math inline">\(u\)</span> with <span class="math inline">\(x\)</span> and <span class="math inline">\(v\)</span> with <span class="math inline">\(y\)</span>, we would get linear constraints like <span class="math inline">\(x + y/2 = 1 \Longrightarrow y = 2 - 2x\)</span>.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>, <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>uv_mat <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(u,v)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(uv_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'u'</span>, <span class="st">'v'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>uv_mat<span class="sc">$</span>density <span class="ot">&lt;-</span> <span class="fu">with</span>(uv_mat, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span> <span class="sc">*</span> (u <span class="sc">+</span> v<span class="sc">/</span><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> u <span class="sc">+</span> v<span class="sc">/</span><span class="dv">2</span> <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> u<span class="sc">-</span>v<span class="sc">/</span><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> u<span class="sc">-</span>v<span class="sc">/</span><span class="dv">2</span> <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>uv_mat <span class="sc">|&gt;</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> u, <span class="at">y =</span> v, <span class="at">fill =</span> <span class="fu">as.factor</span>(density),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">as.factor</span>(density))) <span class="sc">+</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'0'</span> <span class="ot">=</span> <span class="st">'white'</span>, <span class="st">'0.25'</span> <span class="ot">=</span> <span class="st">'cornflowerblue'</span>)) <span class="sc">+</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'0'</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">'0.25'</span> <span class="ot">=</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Density"</span>) <span class="sc">+</span> </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha =</span> <span class="fu">guide_none</span>()) <span class="sc">+</span> </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Probability density function of f"</span>[<span class="st">"U,V"</span>], <span class="st">"(u,v)"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week8_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="example-ratio-of-standard-normals" class="level3">
<h3 class="anchored" data-anchor-id="example-ratio-of-standard-normals">Example: Ratio of Standard Normals</h3>
<p>To illustrate this technique, suppose <span class="math inline">\(X,Y \sim \mathcal N(0,1)\)</span> independently. What is the distribution of <span class="math inline">\(X/Y\)</span>?</p>
<p>Define <span class="math inline">\(U = X / Y\)</span> and <span class="math inline">\(V = Y\)</span>. That is</p>
<p><span class="math display">\[u = g_1(x,y) = x/y
\]</span></p>
<p><span class="math display">\[v = g_2(x,y) = y.
\]</span></p>
<p>Introducing <span class="math inline">\(V = Y\)</span> makes <span class="math inline">\(g\)</span> invertible, so we can use the bivariate transformation formula.</p>
<p>The inverse is <span class="math inline">\(x = h_1(u,v) = uv\)</span> and <span class="math inline">\(y = h_2(u,v) = v.\)</span></p>
<p>Thus the Jacobian matrix is</p>
<p><span class="math display">\[Dh = \begin{bmatrix}
\frac{\partial h_1}{\partial u} &amp; \frac{ \partial h_1}{\partial v} \\
  \frac{\partial h_2}{\partial u} &amp; \frac{\partial h_2}{\partial v}
\end{bmatrix} = \begin{bmatrix}
v &amp; u \\ 0 &amp; 1
\end{bmatrix}.
\]</span></p>
<p>The punchline (which we’ll see soon) is Cauchy.</p>
<p>Therefore the joint pdf of <span class="math inline">\((U,V)\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
f_{U,V}(u,v) &amp; = f_{X,Y}(h_1(u,v), h_2(u,v)) \lvert \det Dh \rvert \\
&amp; = \frac{1}{\sqrt{2\pi}} \exp \left( - \frac{1}{2} (uv)^2 \right) \frac{1}{\sqrt{2\pi}} \exp \left( -\frac{1}{2} v^2 \right) \lvert v \rvert \\
\frac{1}{2\pi} |v| \exp \left( - \frac{1}{2} v^2 (1 + u^2 )\right).
\end{aligned}
\]</span></p>
<p>To find the marginal of <span class="math inline">\(U\)</span>, we need to integrate out <span class="math inline">\(V\)</span>. Making the change of variable <span class="math inline">\(t = v^2, \, \, \mathrm dt = 2v\mathrm dv\)</span>,</p>
<p><span class="math display">\[
\begin{aligned}
\int_0^\infty v \exp \left( -\frac{1}{2} v^2(1+u^2) \right) \mathrm dv &amp; = \frac{1}{2} \int_0^\infty \exp \left( -\frac{1}{2} t (1+u^2) \right) \mathrm d t \\
&amp; = \frac{1}{1 + u^2}.
\end{aligned}
\]</span></p>
<p>Therefore since <span class="math inline">\(f_{U,V}(u,v) = f_{U,V}(u,-v),\)</span></p>
<p><span class="math display">\[f_U(u) = \int_{-\infty}^\infty f_{U,V}(u,v) \mathrm dv = 2 \int_0^\infty f_{U,V}(u,v) \mathrm dv = \frac{1}{\pi} \frac{1}{1+u^2}.
\]</span></p>
<p>We can recognize this as a Cauchy distribution.</p>
</section>
</section>
</section>
<section id="bivariate-normal-distributions" class="level1">
<h1>Bivariate Normal Distributions</h1>
<p>The bivariate normal distribution with means <span class="math inline">\(\mu_X\)</span> and <span class="math inline">\(\mu_Y \in \mathbb R\)</span>, variances <span class="math inline">\(\sigma_X^2, \sigma_Y^2 &gt; 0\)</span>, and correlation <span class="math inline">\(\rho \in (-1,1)\)</span> has pdf</p>
<p><span class="math display">\[f(x,y) = \frac{1}{2 \pi \sigma_X \sigma_Y \sqrt{1-\rho^2}} \exp \left(
-\frac{1}{2 (1-\rho^2)} ( \tilde x^2 - 2 \rho \tilde x\tilde y + \tilde y ^2)
  \right),
\]</span></p>
<p>where</p>
<p><span class="math display">\[\tilde x = \frac{x - \mu_X}{\sigma_X} \quad \quad \text{ and } \quad \quad \tilde y = \frac{y - \mu_Y}{\sigma_Y}
\]</span></p>
<p>If <span class="math inline">\((X,Y)\)</span> have this bivariate normal distribution, then</p>
<ol type="1">
<li><span class="math inline">\(X \sim \mathcal N(\mu_X, \sigma_X^2)\)</span></li>
<li><span class="math inline">\(Y \sim \mathcal N(\mu_Y, \sigma_Y^2)\)</span></li>
<li><span class="math inline">\(\text{Cor}(X,Y) = \rho\)</span></li>
<li><span class="math inline">\(aX + bY\)</span> is normally distributed for any <span class="math inline">\(a,b \neq 0\)</span>.
<ul>
<li>For the <span class="math inline">\(a = b = 0\)</span> case, we need to expand our definition to allow <span class="math inline">\(\sigma^2 = 0\)</span> by considering <span class="math inline">\(\mathcal N(\mu, 0)\)</span> to be the point mass at <span class="math inline">\(\mu\)</span>.</li>
</ul></li>
<li><span class="math inline">\(Y \mid X = x\)</span> is normally distributed with</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}(Y | X = x) &amp; = \mu_Y + \rho \sigma_Y \frac{x - \mu_X}{\sigma X} \\
\text{Var}(Y | X = x ) &amp; = (1 - \rho^2) \sigma_Y^2.
\end{aligned}
\]</span></p>
<p>In other words, the conditional pdf of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X =x\)</span> is</p>
<p><span class="math display">\[p(y\mid x) = \mathcal N \left( y \mid \mu_y + \rho \sigma_Y \frac{x - \mu_X}{\sigma_X}, (1-\rho^2) \sigma_Y^2 \right).
\]</span></p>
<div class="chilltip">
<p>If we allow for correlations of 1 or -1, then we could construct <span class="math inline">\(aX + bY\)</span> such that they cancel exactly, requiring special care.</p>
</div>
<p><br></p>
<p>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are each normally distributed, then <span class="math inline">\((X,Y)\)</span> is <em>not</em> necessarily bivariate normal.</p>
<p>One example is where <span class="math inline">\(\rho = 1\)</span> or <span class="math inline">\(\rho = -1\)</span> since this violates the constraint that <span class="math inline">\(\rho \in (-1,1)\)</span>.</p>
<p>But what about a more satisfying counterexample?</p>
<p>Let’s say <span class="math inline">\(X \sim \mathcal N(0,1)\)</span> and</p>
<p><span class="math display">\[Y = \left\{ \begin{array}{ll}
X \quad &amp; \text{ if } |X| \leq 1 \\
-X \quad &amp; \text{ if } |X| &gt; 1
\end{array} \right. .
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(x) <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="sc">-</span>x, x)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y), <span class="fu">aes</span>(x,y)) <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">15</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(plot1)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ggExtra<span class="sc">::</span><span class="fu">ggMarginal</span>(plot1, <span class="at">type =</span> <span class="st">'histogram'</span>, <span class="at">fill =</span> <span class="st">'#e67e22'</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week8_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We defined the bivariate normal distribution in term of its pdf, but there is a more general definition that we will use.</p>
<p><em>Definition:</em> We will say that <span class="math inline">\((X,Y)\)</span> is bivariate normal if <span class="math inline">\(aX + bY\)</span> is normally distributed for <span class="math inline">\(a,b \in \mathbb R\)</span>.</p>
<p>This definition applies in the degenerate scenario where <span class="math inline">\(\rho = 1\)</span> or -1.</p>
<section id="mean-and-covariance-of-a-random-vector" class="level2">
<h2 class="anchored" data-anchor-id="mean-and-covariance-of-a-random-vector">Mean and Covariance of a Random Vector</h2>
<p>The covariance matrix of a random vector <span class="math inline">\((X,Y)^T = \begin{bmatrix} X \\ Y \end{bmatrix}\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
\text{Cov}\left( \begin{bmatrix} X \\ Y \end{bmatrix} \right) &amp; =
\begin{bmatrix}
\text{Cov}(X,X) &amp; \text{Cov}(X,Y) \\
\text{Cov}(Y,X) &amp; \text{Cov}(Y,Y)
\end{bmatrix} \\
&amp; =
\begin{bmatrix}
\sigma_X^2 &amp; \rho_{X,Y} \sigma_X \sigma_Y \\
\rho_{X,Y} \sigma_X \sigma_Y &amp; \sigma_Y^2
\end{bmatrix}.
\end{aligned}
\]</span></p>
<p>The mean of a random vector <span class="math inline">\((X,Y)^T\)</span> is defined to be the vector of the means of its entries:</p>
<p><span class="math display">\[\mathbb{E}\left( \begin{bmatrix} X \\ Y \end{bmatrix} \right) = \begin{bmatrix} \mathbb{E}X \\ \mathbb{E}Y \end{bmatrix} .
\]</span></p>
<p>For any random vector <span class="math inline">\(X = \begin{bmatrix} X_1 \\ X_2 \end{bmatrix}\)</span> and any <span class="math inline">\(2 \times 2\)</span> matrix <span class="math inline">\(A\)</span>,</p>
<p><span class="math display">\[\text{Cov}(AX) = A \text{Cov}(X) A^T.
\]</span></p>
<p>(Actually this works for any dimensional <span class="math inline">\(A\)</span> as long as the number of rows of <span class="math inline">\(A\)</span> is the same as <span class="math inline">\(\text{length}(X)\)</span>.)</p>
<p>It is common to parameterize bivariate (and more generally, multivariate) normal distributions in terms of the mean vector and covariance matrix. We write</p>
<p><span class="math display">\[
\begin{bmatrix}
X \\ Y
\end{bmatrix} \sim \mathcal N(\mu, \Sigma)
\]</span></p>
<p>to denote that <span class="math inline">\((X,Y)^T\)</span> is bivariate normal such that</p>
<p><span class="math display">\[\mu = \mathbb{E}\left( \begin{bmatrix} X \\ Y \end{bmatrix} \right) \quad \quad \text{ and } \quad \quad \Sigma = \text{Cov}\left( \begin{bmatrix} X \\ Y \end{bmatrix} \right).
\]</span></p>
<p>However, not just any <span class="math inline">\(2 \times 2\)</span> matrix <span class="math inline">\(\Sigma\)</span> can be used. <span class="math inline">\(\Sigma\)</span> must be a symmetric positive semi-definite matrix, that is</p>
<ol type="1">
<li><span class="math inline">\(\Sigma = \Sigma^T\)</span> (symmetric) and</li>
<li><span class="math inline">\(t^T \Sigma t \geq 0\)</span> for all <span class="math inline">\(t \in \mathbb R^2\)</span> (positive semi-definiteness)o</li>
</ol>
<p>We can write <span class="math inline">\(t^T \Sigma t = t_1^2 \Sigma_{11} + t_1 t_2 \Sigma_{12} + t_2 t_1 \Sigma_{21} + t_2^2 \Sigma{22}.\)</span></p>
<p>If <span class="math inline">\(\rho = 1\)</span>, then <span class="math display">\[
\begin{aligned}
t^T \Sigma t &amp; = t_1^2 \sigma_1^2 + 2t_1t_2 \sigma_1 \sigma_2 + t_2^2 \sigma_2^2 \\
&amp; = (t_1 \sigma_1 + t_2 \sigma_2)^2
\end{aligned}.
\]</span></p>
<p>This leads to a useful way of constructing bivariate normal distributions. Let <span class="math inline">\(s_1 \geq s_2 \geq 0\)</span> and <span class="math inline">\(\theta \in [0, 2\pi )\)</span>. Let <span class="math inline">\(Z_1, Z_2 \sim \mathcal N(0,1)\)</span> independently and define</p>
<p><span class="math display">\[
\begin{bmatrix}
X_1 \\ X_2
\end{bmatrix} =
\underbrace{\begin{bmatrix}
\cos \theta &amp; - \sin \theta \\
\sin \theta &amp; \cos \theta
\end{bmatrix}}_{\text{rotation}}
\underbrace{\begin{bmatrix}
s_1 &amp; 0 \\
0 &amp; s_2
\end{bmatrix}}_{\text{scaling}}
\begin{bmatrix}
Z_1 \\ Z_2
\end{bmatrix}.
\]</span></p>
<p>Then <span class="math inline">\((X_1,X_2)^T\)</span> is bivariate normal such that the line along which <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are correlated at angle <span class="math inline">\(\theta\)</span>, the scale along this line is <span class="math inline">\(s_1\)</span> and the scale orthogonal to the line is <span class="math inline">\(s_2\)</span>.</p>
<p>Conversely, given <span class="math inline">\(\Sigma\)</span> we can recover the scaling and rotation.</p>
<p>Compute the eigendecomposition <span class="math inline">\(\Sigma = U \Lambda U^T\)</span> where <span class="math inline">\(U\)</span> is an orthogonal matrix and <span class="math inline">\(\Lambda = \text{diag}(\lambda_1, \lambda_2)\)</span>, with <span class="math inline">\(\lambda_1 \geq \lambda_2 \geq 0\)</span>.</p>
<p>Recall that a matrix is orthogonal if <span class="math inline">\(U^TU = I\)</span> and <span class="math inline">\(UU^T = I\)</span>.</p>
<p>Then <span class="math inline">\(\lambda_1 = s_1^2\)</span>, <span class="math inline">\(\lambda_2 = s_2^2\)</span>, and <span class="math inline">\(U\)</span> is the rotation matrix.</p>
<p>Then we can represent <span class="math inline">\(\begin{bmatrix} X_1 \\ X_2 \end{bmatrix} \sim \mathcal N(0,\Sigma)\)</span> as</p>
<p><span class="math display">\[
\begin{bmatrix}
X_1 \\ X_2
\end{bmatrix} =
\underbrace{\begin{bmatrix}
u_{11} &amp; u_{12} \\
u_{21} &amp; u_{22} \\
\end{bmatrix}}_{U \,\text{ (rotation)}}
\underbrace{\begin{bmatrix}
\sqrt{\lambda_1} &amp; 0 \\
0 &amp; \sqrt{\lambda_2}
\end{bmatrix}}_{\Lambda^{1/2} \,\text{ (scaling)}}
\begin{bmatrix}
Z_1 \\ Z_2
\end{bmatrix},
\]</span></p>
<p>where <span class="math inline">\(Z_1, Z_2 \sim \mathcal N(0,1)\)</span> independently.</p>
<p>Or, more succinctly, <span class="math inline">\(X = U \Lambda^{1/2} Z\)</span>.</p>
<div class="chilltip">
<p>Instead of a location-scale family, this is like a <em>rotation</em>-scale+location family!</p>
</div>
<p><br></p>
<p>So the above show two methods:</p>
<ul>
<li>Starting from angles and scales to produce a bivariate matrix;</li>
<li>Or starting from a covariance matrix using eigendecomposition to determine the rotation and scales necessary to yield that covariance matrix.</li>
</ul>
<div class="hottip">
<p>If this looks scary, brush up on your linear algebra:</p>
<p>Diagonalization of symmetric matrices; eigendecomposition.</p>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../week7/week7.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Week 7</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../week9/week9.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Week 9</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>