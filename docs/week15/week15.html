<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Probability (BST 230) Notes - 15&nbsp; Week 15</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../week14/week14.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-title">Week 15</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Probability (BST 230) Notes</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Methods (BST 232) Notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week1/week1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week2/week2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week3/week3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week4/week4.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week5/week5.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week6/week6.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week7/week7.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 7</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week8/week8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week9/week9.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 9</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week10/week10.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week11/week11.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 11</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week13/week13.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 13</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week14/week14.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Week 14</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week15/week15.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Week 15</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#finishing-up-the-borel-cantelli-lemma" id="toc-finishing-up-the-borel-cantelli-lemma" class="nav-link active" data-scroll-target="#finishing-up-the-borel-cantelli-lemma">Finishing up the Borel-Cantelli Lemma</a></li>
  <li><a href="#proof-of-slln-for-bounded-random-variables" id="toc-proof-of-slln-for-bounded-random-variables" class="nav-link" data-scroll-target="#proof-of-slln-for-bounded-random-variables">Proof of SLLN for Bounded Random Variables</a></li>
  <li><a href="#random-walks-and-markov-chains" id="toc-random-walks-and-markov-chains" class="nav-link" data-scroll-target="#random-walks-and-markov-chains">Random Walks and Markov Chains</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#random-walks" id="toc-random-walks" class="nav-link" data-scroll-target="#random-walks">Random Walks</a></li>
  <li><a href="#generating-functions" id="toc-generating-functions" class="nav-link" data-scroll-target="#generating-functions">Generating Functions</a></li>
  <li><a href="#simple-random-walks" id="toc-simple-random-walks" class="nav-link" data-scroll-target="#simple-random-walks">Simple Random Walks</a></li>
  <li><a href="#branching-processes" id="toc-branching-processes" class="nav-link" data-scroll-target="#branching-processes">Branching Processes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Week 15</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- Start of what won't be on the Final -->
<section id="finishing-up-the-borel-cantelli-lemma" class="level1">
<h1>Finishing up the Borel-Cantelli Lemma</h1>
<p>Suppose <span class="math inline">\(A_1, A_2, ...\)</span> is a sequence of events.</p>
<ol type="1">
<li><p>If <span class="math inline">\(\sum_{n=1}^\infty P(A_n) &lt; \infty\)</span> then <span class="math display">\[P(A_n \text{ i.o.}) = 0.\]</span></p></li>
<li><p>If <span class="math inline">\(\sum_{n=1}^\infty P(A_n) = \infty\)</span> and <span class="math inline">\(A_1, A_2, ...\)</span> are mutually independent, then <span class="math inline">\((A_n \text{ i.o.}) = 1.\)</span></p></li>
</ol>
<p>Proof: We’ll only prove 1 here. Suppose <span class="math inline">\(\sum_{n=1}^\infty P(A_n) &lt; \infty.\)</span> Define <span class="math inline">\(X(s) = \sum_{n=1}^\infty \mathbb 1(s \in A_n) \in \{ 0, 1, 2, ... \} \cup \{ \infty \}.\)</span> Then</p>
<p><span class="math display">\[P(A_n \text{ i.o.}) = P\left( \left\{ s \in S : \sum_{n=1}^\infty \mathbb 1(s \in A_n) = \infty \right\}\right) = P(X = \infty).\]</span></p>
<p>If <span class="math inline">\(P(X = \infty) &gt; 0\)</span>, then <span class="math inline">\(\mathbb{E}X = \infty\)</span>. However,</p>
<p><span class="math display">\[\mathbb{E}X = \sum_{n=1}^\infty P(A_n) &lt; \infty\]</span></p>
<p>by assumption, so it must be the case that <span class="math inline">\(P(X = \infty) = 0\)</span>.</p>
<div class="hottip">
<p>TJ asks if this requires the monotone convergence theorem.</p>
<p>I think about: <span class="math display">\[\mathbb{E}X = \sum_{n=1}^\infty P(A_n) \]</span></p>
</div>
</section>
<section id="proof-of-slln-for-bounded-random-variables" class="level1">
<h1>Proof of SLLN for Bounded Random Variables</h1>
<p>Suppose <span class="math inline">\(X_1, X_2, ...\)</span> iid and <span class="math inline">\(P(|X| &lt; c) = 1\)</span> for some <span class="math inline">\(c\)</span>.</p>
<p>Let <span class="math inline">\(\varepsilon &gt; 0\)</span>. By Hoeffding’s inequality, defining <span class="math inline">\(\mu = \mathbb{E}X_1\)</span>,</p>
<p><span class="math display">\[P(|\bar X_n - \mu| &gt; \varepsilon) \leq 2 \exp (-\frac{1}{2} \varepsilon^2 n / c^2).\]</span></p>
<p>Define <span class="math inline">\(A_n\)</span> to be the event that <span class="math inline">\(|\bar X_n - \mu| &gt; \varepsilon\)</span>. Then</p>
<p><span class="math display">\[\sum_{n=1}^\infty P(A_n) \leq \sum_{n=1}^\infty 2 \exp (-\frac{1}{2} \varepsilon^2 n/c^2) &lt; \infty.\]</span></p>
<p>Thus, by Borel-Cantelli, <span class="math inline">\(P(A_n \text{ i.o.}) = 0\)</span>. Consequently,</p>
<p><span class="math display">\[P\left( \limsup_{n\to\infty} |\bar X_n - \mu| \leq \varepsilon \right) = P(\{ A_n \text{ i.o.}^c\}) = 1.\]</span></p>
<p>Since this holds for all <span class="math inline">\(\varepsilon &gt; 0\)</span>, this implies that</p>
<p><span class="math display">\[\bar X_n \xrightarrow[n\to\infty]{a.s.} \mu.\]</span></p>
</section>
<section id="random-walks-and-markov-chains" class="level1">
<h1>Random Walks and Markov Chains</h1>
<p>Outline:</p>
<ul>
<li>Intro</li>
<li>Generating Functions</li>
<li>Simple Random Walks</li>
<li>Branching Processes</li>
</ul>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>A stochastic process is an infinite-dimensional random object.</p>
<p>This sounds complicated, but we’ve already been working with stochastic processes. For example, a sequence of random variables <span class="math inline">\(X_1, X_2, ...\)</span> is a stochastic process.</p>
<p>More generally, a stochastic process may be a random function, such as a random function <span class="math inline">\(H(x)\)</span> on the real numbers <span class="math inline">\(x \in \mathbb{R}\)</span>.</p>
<p>A Markov chain is a sequence <span class="math inline">\(X_1, X_2, ...\)</span> such that</p>
<p><span class="math display">\[X_{t+1} \perp\!\!\!\perp X_{1:t-1} \mid X_{t}.\]</span></p>
<p>Before looking at Markov chains in general, we’ll look at random walks and branching processes.</p>
<p><span class="math display">\[X = (X_1, X_2, ...)\]</span> <span class="math display">\[X(s) = (X_1(s), X_2(s), ...)\]</span></p>
<p>It could also be that for every sample in the sample space gives us a different function <span class="math inline">\(H(s)(x)\)</span>. A classic example of this is Gaussian Processes. The core idea is that a random function is also a stochastic process.</p>
</section>
<section id="random-walks" class="level2">
<h2 class="anchored" data-anchor-id="random-walks">Random Walks</h2>
<p>Random walks are canonical examples of Markov chains.</p>
<p>A sequence of random variables <span class="math inline">\(Y_0, Y_1, ...\)</span> is a random ralk if <span class="math inline">\(Y_0 = 0\)</span> (it doesn’t have to) and <span class="math inline">\(Y_n = \sum_{n=1}^n X_i\)</span> where <span class="math inline">\(X_1, X_2, ...\)</span> are iid.</p>
<p>It is a <em>simple random walk</em> with parameter <span class="math inline">\(p\)</span> if <span class="math inline">\(X_i \in \{ -1, 1\}\)</span> such that <span class="math inline">\(P(X_i = 1) = p\)</span> and <span class="math inline">\(P(X_i = -1) = q = 1-p\)</span>.</p>
<p>From the LLN and CLT, we know the asymptotics of <span class="math inline">\(\frac{1}{n} (Y_n - \mathbb{E}Y_n)\)</span> and <span class="math inline">\(\frac{1}{\sqrt{n}}(Y_n - \mathbb{E}Y_n).\)</span></p>
<p>However, a lot more can be said about the properties of <span class="math inline">\(Y_n\)</span>.</p>
<p>Since much of statistics involves sample averages, understanding these properties can be useful.</p>
</section>
<section id="generating-functions" class="level2">
<h2 class="anchored" data-anchor-id="generating-functions">Generating Functions</h2>
<p>The analysis of random walks (and many other combinatorial objects) is simplified by the use of generating functions.</p>
<p>The generating function (gf) of a sequence of real numbers,</p>
<p>$<span class="math inline">\(a_0, a_1, a_2, ... \in \mathbb{R}\)</span> is</p>
<p><span class="math display">\[G_a(s) = \sum_{n=0}^\infty a_n s^n.\]</span></p>
<p>Generating functions are closely related to mgfs for discrete r.v.s but they afford more flexibility since the <span class="math inline">\(a_n\)</span>s may be negative and do not necessarily sum to 1.</p>
<p>The probability generating function (pgf) of a random variable <span class="math inline">\(X\)</span> is</p>
<p><span class="math display">\[G_X(s) = \mathbb{E}(s^X).\]</span></p>
<p>The relationship between the pgf and mgf is simply that</p>
<p><span class="math display">\[M_X(t) = G_X(e^t).\]</span></p>
<p>The gf of <span class="math inline">\(a = (1, 1, 1, 1, ...)\)</span> is the geometric series</p>
<p><span class="math display">\[G_a(s) = \sum_{n=0}^\infty s^n = \frac{1}{1-s}.\]</span></p>
<p>For a fixed <span class="math inline">\(N\)</span>, suppose <span class="math inline">\(a_n = { n \choose n } \mathbb 1(0 \leq n \leq N)\)</span> is the binomial coefficient. The gf of <span class="math inline">\(a_0, a_1, a_2, ...\)</span> is</p>
<p><span class="math display">\[G_a(s) = \sum_{n=0}^\infty a_n s^n = \sum_{n=0}^N { N \choose n} s^n = (1+s)^N.\]</span></p>
<p>(This uses the Binomial Theorem.)</p>
<p>Suppose <span class="math inline">\(a_n = {2n \choose n}\)</span> for <span class="math inline">\(n = 0, 1, 2, ...\)</span>. These are called the central binomial coefficients and their gf is</p>
<p><span class="math display">\[G_a(s) = \sum_{n=0}^\infty { 2n \choose n} s^n = (1-4s)^{-1/2}.\]</span></p>
<p>The central binomial coefficients are the elements going straight down the middle of Pascal’s triangle.</p>
<div class="cooltip">
<p><span class="math display">\[G(s) = \sum_{n=0}^\infty s_n = \frac{1}{1-s}\]</span></p>
<p><span class="math display">\[G'(s) = \sum_{n=0}^\infty n s^{n-1} = \frac{1}{(1-s)^2}.\]</span></p>
<p><span class="math display">\[s = -1/2\]</span></p>
<p><span class="math display">\[G'(-1/2) = \sum_{n=0}^\infty n (-1/2)^{n-1} = \frac{1}{(1+1/2)^2} = 4/9.\]</span></p>
<p><span class="math display">\[\sum_{n=1}^\infty (-1)^{n-1} \frac{n}{2^{n-1}} = \sum_{k=0}^\infty (-1)^k \frac{k+1}{2^k}.\]</span></p>
</div>
<p>The convolution of <span class="math inline">\(a_n\)</span> and <span class="math inline">\(b_n\)</span> is the sequence <span class="math inline">\(c_n\)</span> defined by</p>
<p><span class="math display">\[c_n = a_0 b_0 + a_1 b_n-1 + ... + a_n b_0 = \sum_{k=0}^n a_k b_{n-k}.\]</span></p>
<p>The convolution <span class="math inline">\(c\)</span> is denoted <span class="math inline">\(a * b\)</span>.</p>
<p>Convolution formula. <span class="math inline">\(G_{a * b}(s) = G_a(s) G_b(s).\)</span></p>
<p><span class="math display">\[
\begin{aligned}
G_{a*b}(s) &amp; = \sum_{n=0}^\infty \left( \sum_{k=0}^n a_k b_{n-k} \right) s^n  \\
&amp; = \sum_{n=0}^\infty \sum_{k=0}^n a_k s^{k} b_{n-k} s^{n-k} \\
&amp; = \sum_{n=0}^\infty \sum_{k=0}^\infty a_k s^{k} b_{n-k} s^{n-k} \\
&amp; = \left( \sum_{k=0}^\infty a_k s^k \right) \left( \sum_{j=0}^\infty b_j s^{j} \right) = G_a(s) G_b(s). \\
\end{aligned}
\]</span></p>
<div class="cooltip">
<p>The Fast Fourier Transform underlies a lot of signal processing, and the Fourier transform is quite similar to this. They’re basically a fast way of computing convolutions by first converting sequences to something like the generating function and then multiplying element-wise.</p>
</div>
</section>
<section id="simple-random-walks" class="level2">
<h2 class="anchored" data-anchor-id="simple-random-walks">Simple Random Walks</h2>
<p>Let <span class="math inline">\(Y_n\)</span> be a simple random walk with parameter <span class="math inline">\(p\)</span> and let <span class="math inline">\(T_0 = \min\{ n &gt; 0 : Y_n = 0\}\)</span> be the first time that <span class="math inline">\(Y_n\)</span> returns to the origin. (If <span class="math inline">\(Y_n \neq 0\)</span> for all <span class="math inline">\(n &gt; 0\)</span> then we define <span class="math inline">\(T_0 = \infty\)</span>.)</p>
<p>Define <span class="math inline">\(a_n = P(T_0 = n)\)</span> and <span class="math inline">\(b_n = P(Y_n = 0)\)</span>.</p>
<p>The generating functions of these two sequences are</p>
<p><span class="math display">\[G_a(s) = \sum_{n=0}^\infty a_n s^n \quad \text{ and } \quad G_b(s) = \sum_{n=0}^\infty b_n s^n.\]</span></p>
<p>Theorem:</p>
<ol type="1">
<li><p><span class="math inline">\(G_b(s) = 1 + G_a(s) G_b(s)\)</span></p></li>
<li><p>$G_b(s) = (1-4pqs<sup>2)</sup>{-1/2}</p></li>
<li><p><span class="math inline">\(G_a(s) = 1- (1-4pqs^2)^{1/2}\)</span></p></li>
</ol>
<p>Before proving this result, let’s see how it’s useful.</p>
<p>The probability of eveer returning to the origin is</p>
<p><span class="math display">\[\sum_{n=0}^\infty P(T_0 = n) = \sum_{n=0}^\infty a_n = G_a(1) = 1-(1-4pq)^{1/2} = 1 - |p-q|\]</span></p>
<p>after simplifying a bit using the fact that <span class="math inline">\(p + q = 1\)</span>.</p>
<p>Thus, after <span class="math inline">\(p = q = 1/2\)</span>, then the probability of returning is 1.</p>
<p>As <span class="math inline">\(p\)</span> gets smaller, the probability of returning tends to 0.</p>
<p>If <span class="math inline">\(p = q = 1/2\)</span>, the expected time of first return is</p>
<p><span class="math display">\[\begin{aligned}
\sum_{n=0}^\infty nP(T_0 = n) &amp; = \sum_{n=0}^\infty n a_n = G_a'(1)  \\
&amp; = \frac{d}{ds} \large \vert_{s=1} \left(1-(1-s^2)^{1/2}\right) \\
&amp; = - \frac{1}{2} (1-s^2)^{-1/2} (-2s) \large \vert_{s=1} = \infty.
\end{aligned}
\]</span></p>
<!--
grimmett and stirzaker probability and random processes
-->
</section>
<section id="branching-processes" class="level2">
<h2 class="anchored" data-anchor-id="branching-processes">Branching Processes</h2>
<p>A branching process is a mathematical model of the size of a population of individuals over time.</p>
<p>Let <span class="math inline">\(Z_n\)</span> denote the number of individuals at generation <span class="math inline">\(n\)</span>. For simplicity, assume <span class="math inline">\(Z_0 = 1\)</span>.</p>
<p>Suppose that generation <span class="math inline">\(n\)</span>, individual <span class="math inline">\(i\)</span> has a random number of offspring, <span class="math inline">\(X_{n, i}\)</span>.</p>
<p>Assume only the offspring survive to the next generation.</p>
<p>Assume the numbers of offspring <span class="math inline">\(X_{n,1}, X_{n,2}, ...\)</span> are iid with common pgf <span class="math inline">\(G_X(s)\)</span>.</p>
<p>To analyze this branching process, we’ll use some more properties of generating functions.</p>
<p>*Compounding formula.$ Suppose <span class="math inline">\(X_1, X_2, ...\)</span> are iid with common pgf <span class="math inline">\(G_X(s)\)</span> and <span class="math inline">\(N \in \{ 0, 1, 2, ...\}\)</span> is a random variable pgf <span class="math inline">\(G_N(s)\)</span>. Then the pgf of the compound variable <span class="math inline">\(Z=X_1 + ... + X_n\)</span> is <span class="math display">\[G_Z(s) = G_N(G_X(s)).\]</span></p>
<p>Moment formulas. If <span class="math inline">\(X\)</span> has pgf <span class="math inline">\(G(s)\)</span>, then</p>
<ol type="1">
<li><span class="math inline">\(G(1) = 1.\)</span></li>
<li><span class="math inline">\(\mathbb{E}(X) = G'(1)\)</span>.</li>
<li><span class="math inline">\(\mathbb{E}(X(X-1) \cdots (X-k+1)) = G^{(k)}(1).\)</span></li>
<li><span class="math inline">\(\text{Var}(X) = G''(1) + G'(1) (1-G'(1))\)</span>.</li>
</ol>
<p>At generation <span class="math inline">\(n\)</span>, the total number of offspring is</p>
<p><span class="math display">\[Z_{n+1} = X_{n,1} + X_{n,2} + ... + X_{n, Z_n}.\]</span></p>
<p>Thus, by the compounding formula, the pgf of <span class="math inline">\(Z_{n+1}\)</span> is</p>
<p><span class="math display">\[G_{Z_{n+1}} = G_{Z_n} ( G_X(s)).\]</span></p>
<p>Iterating this formula yields that</p>
<p><span class="math display">\[\begin{aligned}
G_{Z_n}(s) = G_{Z_{n-1}}(G_X(s)) = G_{Z_{n-2}}(G_X(G_X(s))) \\
&amp; = G_X(G_X(\cdots G_X(s) \cdots ))
\end{aligned}
\]</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../week14/week14.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Week 14</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>